import defaultReceiptConfig from "./config/receipt.js";
import {
  alternativeSstData,
  cashboxData,
  fiscalReceiptDataMock,
  getServiceInputBodyMock,
  getServiceOutputBodyMock,
  xReportDataMock,
  zReportDataMock,
} from "../../mock.js";
import {
  generateTextFiscalReceipt,
  generateTextServiceTransactionReceipt,
  generateXZReport,
} from "./index.js";
import cleanUpReceiptText from "./helpers/cleanUpReceiptText.js";

describe("receiptGenerator", () => {
  it("generateFiscalReceipt should has this structure", () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "----------------------------------------",
      "Ğ§ĞµĞº â„–           485                     ",
      "Ğ¢Ğ¸Ğ¿ Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ  Ğ£ Ğ·Ğ°ĞºĞ»Ğ°Ğ´Ñ–               ",
      "Ğ’Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ğ¾        16 Ğ»Ğ¸Ğ¿Ğ½Ñ 2024 19:29:35  ",
      "ĞĞ°Ğ´Ñ€ÑƒĞºĞ¾Ğ²Ğ°Ğ½Ğ¾     16 Ğ»Ğ¸Ğ¿Ğ½Ñ 2024 19:30:35  ",
      "Ğ¡Ñ‚Ñ–Ğ» â„–          6 (ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Ğ·Ğ°Ğ»)        ",
      "Ğš-ÑÑ‚ÑŒ Ğ³Ğ¾ÑÑ‚ĞµĞ¹    2                       ",
      "",
      "----------------------------------------",
      "2 x 130,02                              ",
      "2204109600                              ",
      "12345678                                ",
      "ADCC123123                              ",
      "Ğ’Ğ¸Ğ½Ğ¾ Ğ¸Ğ³Ñ€Ğ¸ÑÑ‚Ğ¾Ğµ Ğ²ĞºÑƒÑĞ½Ğ¾Ğµ         260,04  Ğ”Ğ“",
      "Ğ—Ğ½Ğ¸Ğ¶ĞºĞ°                         10,04  Ğ”Ğ“",
      "Ğ¦Ñ–Ğ½Ğ° Ğ·Ñ– Ğ·Ğ½Ğ¸Ğ¶ĞºĞ¾Ñ               250,00  Ğ”Ğ“",
      "                                        ",
      "4 x 260,00                              ",
      "2204888600                              ",
      "Ğ¡Ğ¸Ñ€                          1040,00   Ğ”",
      "                                        ",
      "Ğ¡Ğ¸Ñ€Ğ½Ğ° Ğ¿Ğ°Ğ»Ğ¾Ñ‡ĞºĞ°                   5,00   Ğ”",
      "",
      "----------------------------------------",
      "ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ‘Ğ°Ğ½Ğº                              ",
      "S1260S6Y                                ",
      "ĞĞ¿Ğ»Ğ°Ñ‚Ğ°                                  ",
      "Ğ•ĞŸĞ—                     4422********6333",
      "ĞŸĞ›ĞĞ¢Ğ†Ğ–ĞĞ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ                    VISA",
      "ĞšĞĞ” ĞĞ’Ğ¢.                          159345",
      "RRN                         083998389823",
      "",
      "----------------------------------------",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                      1000,00 Ğ³Ñ€Ğ½",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                  295,00 Ğ³Ñ€Ğ½",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "----------------------------------------",
      "Ğ¡ÑƒĞ¼Ğ°                         1295,00 Ğ³Ñ€Ğ½",
      "ĞŸĞ”Ğ’ 0% Ğ“ 0%                         0,00",
      "ĞĞºÑ†Ğ¸Ğ· Ğ” 5%                         61,66",
      "----------------------------------------",
      "Ğ”Ğ¾ ÑĞ¿Ğ»Ğ°Ñ‚Ğ¸                    1295,00 Ğ³Ñ€Ğ½",
      "Ğ ĞµÑˆÑ‚Ğ°                           0,00 Ğ³Ñ€Ğ½",
      "----------------------------------------",
      "     ĞĞ° Ğ²Ğ°Ñ Ñ‡ĞµĞºĞ°Ñ” Ğ¿Ñ€Ğ¸Ñ”Ğ¼Ğ½Ğ¸Ğ¹ ÑÑÑ€Ğ¿Ñ€Ğ¸Ğ·!     ",
      "----------------------------------------",
      "            Ğ§ĞµĞº â„– 2462757750            ",
      "           16.05.2024 19:29:35          ",
      "                 ĞĞĞ›ĞĞ™Ğ                 ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "             Ğ¤Ğ†Ğ¡ĞšĞĞ›Ğ¬ĞĞ˜Ğ™ Ğ§Ğ•Ğš             ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      generateTextFiscalReceipt({
        ...fiscalReceiptDataMock,
        receiptConfig: defaultReceiptConfig,
      }),
    ).toEqual(expectedReceipt);
  });

  it("offline generateFiscalReceipt should has this structure", () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "----------------------------------------",
      "Ğ§ĞµĞº â„–           485                     ",
      "Ğ¢Ğ¸Ğ¿ Ğ·Ğ°Ğ¼Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ  Ğ£ Ğ·Ğ°ĞºĞ»Ğ°Ğ´Ñ–               ",
      "Ğ’Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ğ¾        16 Ğ»Ğ¸Ğ¿Ğ½Ñ 2024 19:29:35  ",
      "ĞĞ°Ğ´Ñ€ÑƒĞºĞ¾Ğ²Ğ°Ğ½Ğ¾     16 Ğ»Ğ¸Ğ¿Ğ½Ñ 2024 19:30:35  ",
      "Ğ¡Ñ‚Ñ–Ğ» â„–          6 (ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Ğ·Ğ°Ğ»)        ",
      "Ğš-ÑÑ‚ÑŒ Ğ³Ğ¾ÑÑ‚ĞµĞ¹    2                       ",
      "",
      "----------------------------------------",
      "2 x 130,02                              ",
      "2204109600                              ",
      "12345678                                ",
      "ADCC123123                              ",
      "Ğ’Ğ¸Ğ½Ğ¾ Ğ¸Ğ³Ñ€Ğ¸ÑÑ‚Ğ¾Ğµ Ğ²ĞºÑƒÑĞ½Ğ¾Ğµ         260,04  Ğ”Ğ“",
      "Ğ—Ğ½Ğ¸Ğ¶ĞºĞ°                         10,04  Ğ”Ğ“",
      "Ğ¦Ñ–Ğ½Ğ° Ğ·Ñ– Ğ·Ğ½Ğ¸Ğ¶ĞºĞ¾Ñ               250,00  Ğ”Ğ“",
      "                                        ",
      "4 x 260,00                              ",
      "2204888600                              ",
      "Ğ¡Ğ¸Ñ€                          1040,00   Ğ”",
      "                                        ",
      "Ğ¡Ğ¸Ñ€Ğ½Ğ° Ğ¿Ğ°Ğ»Ğ¾Ñ‡ĞºĞ°                   5,00   Ğ”",
      "",
      "----------------------------------------",
      "ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ‘Ğ°Ğ½Ğº                              ",
      "S1260S6Y                                ",
      "ĞĞ¿Ğ»Ğ°Ñ‚Ğ°                                  ",
      "Ğ•ĞŸĞ—                     4422********6333",
      "ĞŸĞ›ĞĞ¢Ğ†Ğ–ĞĞ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ                    VISA",
      "ĞšĞĞ” ĞĞ’Ğ¢.                          159345",
      "RRN                         083998389823",
      "",
      "----------------------------------------",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                      1000,00 Ğ³Ñ€Ğ½",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                  295,00 Ğ³Ñ€Ğ½",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "----------------------------------------",
      "Ğ¡ÑƒĞ¼Ğ°                         1295,00 Ğ³Ñ€Ğ½",
      "ĞŸĞ”Ğ’ 0% Ğ“ 0%                         0,00",
      "ĞĞºÑ†Ğ¸Ğ· Ğ” 5%                         61,66",
      "----------------------------------------",
      "Ğ”Ğ¾ ÑĞ¿Ğ»Ğ°Ñ‚Ğ¸                    1295,00 Ğ³Ñ€Ğ½",
      "Ğ ĞµÑˆÑ‚Ğ°                           0,00 Ğ³Ñ€Ğ½",
      "----------------------------------------",
      "     ĞĞ° Ğ²Ğ°Ñ Ñ‡ĞµĞºĞ°Ñ” Ğ¿Ñ€Ğ¸Ñ”Ğ¼Ğ½Ğ¸Ğ¹ ÑÑÑ€Ğ¿Ñ€Ğ¸Ğ·!     ",
      "----------------------------------------",
      "          Ğ§ĞµĞº â„– 31619581.2.2634         ",
      "           16.05.2024 19:29:35          ",
      "                 ĞĞ¤Ğ›ĞĞ™Ğ                 ",
      "                  2634                  ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "             Ğ¤Ğ†Ğ¡ĞšĞĞ›Ğ¬ĞĞ˜Ğ™ Ğ§Ğ•Ğš             ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      generateTextFiscalReceipt({
        ...fiscalReceiptDataMock,
        fiscalId: "31619581.2.2634",
        isOffline: true,
        cashboxData,
        receiptConfig: defaultReceiptConfig,
      }),
    ).toEqual(expectedReceipt);
  });

  it("generateFiscalReceipt with alternative sstData", () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "----------------------------------------",
      "2 x 130,02                              ",
      "2204109600                              ",
      "12345678                                ",
      "ADCC123123                              ",
      "Ğ’Ğ¸Ğ½Ğ¾ Ğ¸Ğ³Ñ€Ğ¸ÑÑ‚Ğ¾Ğµ Ğ²ĞºÑƒÑĞ½Ğ¾Ğµ         260,04  Ğ”Ğ“",
      "Ğ—Ğ½Ğ¸Ğ¶ĞºĞ°                         10,04  Ğ”Ğ“",
      "Ğ¦Ñ–Ğ½Ğ° Ğ·Ñ– Ğ·Ğ½Ğ¸Ğ¶ĞºĞ¾Ñ               250,00  Ğ”Ğ“",
      "                                        ",
      "4 x 260,00                              ",
      "2204888600                              ",
      "Ğ¡Ğ¸Ñ€                          1040,00   Ğ”",
      "                                        ",
      "Ğ¡Ğ¸Ñ€Ğ½Ğ° Ğ¿Ğ°Ğ»Ğ¾Ñ‡ĞºĞ°                   5,00   Ğ”",
      "",
      "----------------------------------------",
      "S1K70F0U                                ",
      "ĞĞ¿Ğ»Ğ°Ñ‚Ğ°                                  ",
      "Ğ•ĞŸĞ—                     XXXXXXXXXXXX1935",
      "ĞŸĞ›ĞĞ¢Ğ†Ğ–ĞĞ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ              MasterCard",
      "ĞšĞĞ” ĞĞ’Ğ¢.                          400035",
      "RRN                         085875832176",
      "",
      "----------------------------------------",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                      1000,00 Ğ³Ñ€Ğ½",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                  295,00 Ğ³Ñ€Ğ½",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "----------------------------------------",
      "Ğ¡ÑƒĞ¼Ğ°                         1295,00 Ğ³Ñ€Ğ½",
      "ĞŸĞ”Ğ’ 0% Ğ“ 0%                         0,00",
      "ĞĞºÑ†Ğ¸Ğ· Ğ” 5%                         61,66",
      "----------------------------------------",
      "Ğ”Ğ¾ ÑĞ¿Ğ»Ğ°Ñ‚Ğ¸                    1295,00 Ğ³Ñ€Ğ½",
      "Ğ ĞµÑˆÑ‚Ğ°                           0,00 Ğ³Ñ€Ğ½",
      "----------------------------------------",
      "            Ğ§ĞµĞº â„– 2462757750            ",
      "           16.05.2024 19:29:35          ",
      "                 ĞĞĞ›ĞĞ™Ğ                 ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "             Ğ¤Ğ†Ğ¡ĞšĞĞ›Ğ¬ĞĞ˜Ğ™ Ğ§Ğ•Ğš             ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      generateTextFiscalReceipt({
        ...fiscalReceiptDataMock,
        headerServiceData: null,
        footerServiceData: null,
        sstData: alternativeSstData,
        receiptConfig: defaultReceiptConfig,
      }),
    ).toEqual(expectedReceipt);
  });

  it("generateTextServiceTransactionReceipt should has this structure for input", () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "----------------------------------------",
      "            Ğ¡Ğ›Ğ£Ğ–Ğ‘ĞĞ’Ğ• Ğ’ĞĞ•Ğ¡Ğ•ĞĞĞ¯           ",
      "----------------------------------------",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                      2850,00 Ğ³Ñ€Ğ½",
      "",
      "----------------------------------------",
      "           16.05.2024 19:28:35          ",
      "                 ĞĞĞ›ĞĞ™Ğ                 ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "              Ğ¡Ğ›Ğ£Ğ–Ğ‘ĞĞ’Ğ˜Ğ™ Ğ§Ğ•Ğš             ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      generateTextServiceTransactionReceipt(getServiceInputBodyMock),
    ).toEqual(expectedReceipt);
  });

  it("generateTextServiceTransactionReceipt should has this structure for output", async () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "----------------------------------------",
      "           Ğ¡Ğ›Ğ£Ğ–Ğ‘ĞĞ’Ğ• Ğ’Ğ˜Ğ›Ğ£Ğ§Ğ•ĞĞĞ¯           ",
      "----------------------------------------",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                       750,00 Ğ³Ñ€Ğ½",
      "",
      "----------------------------------------",
      "           16.05.2024 19:28:35          ",
      "                 ĞĞĞ›ĞĞ™Ğ                 ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "              Ğ¡Ğ›Ğ£Ğ–Ğ‘ĞĞ’Ğ˜Ğ™ Ğ§Ğ•Ğš             ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      await generateTextServiceTransactionReceipt(getServiceOutputBodyMock),
    ).toEqual(expectedReceipt);
  });

  it("generateXReport should has this structure", () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "                 X-Ğ·Ğ²Ñ–Ñ‚                 ",
      "----------------------------------------",
      "Ğ—Ğ¼Ñ–Ğ½Ğ° Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ğ°       24.05.2024 16:20:05",
      "ĞÑÑ‚Ğ°Ğ½Ğ½Ñ–Ğ¹ Ñ„Ñ–ÑĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹  27.05.2024 20:22:06",
      "Ñ‡ĞµĞº                                     ",
      "Ğ¤Ñ–ÑĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€              2469255615",
      "Ğ¾ÑÑ‚Ğ°Ğ½ÑŒĞ¾Ğ³Ğ¾ Ñ‡ĞµĞºÑƒ                          ",
      "Ğ’Ğ°Ğ»ÑÑ‚Ğ° Ğ·Ğ²Ñ–Ñ‚Ñƒ                         Ğ³Ñ€Ğ½",
      "",
      "                 ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶                 ",
      "----------------------------------------",
      "Ğ—Ğ°Ğ³Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¾Ğ±Ñ–Ğ³                   2681,80",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                          2020,80",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                      661,00",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "                                        ",
      "ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ñ‡ĞµĞºÑ–Ğ²                       31",
      "",
      "ĞŸĞ”Ğ’ Ğ’ 7%                                ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                       24,60",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                  326,84",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                  351,44",
      "",
      "ĞŸĞ”Ğ’ Ğ“ 20%                               ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                      184,26",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                  737,04",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                  921,30",
      "",
      "ĞĞºÑ†Ğ¸Ğ·Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´Ğ°Ñ‚Ğ¾Ğº Ğ” 5%                   ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                      127,70",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                 2426,20",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                 2553,90",
      "",
      "               ĞŸĞ¾Ğ²ĞµÑ€Ğ½ĞµĞ½Ğ½Ñ               ",
      "----------------------------------------",
      "Ğ—Ğ°Ğ³Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¾Ğ±Ñ–Ğ³                     31,04",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                            30,00",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                        1,04",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ñ‡ĞµĞºÑ–Ğ²                        2",
      "",
      "ĞŸĞ”Ğ’ Ğ’ 7%                                ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                        2,03",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                   26,98",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                   29,01",
      "",
      "ĞĞºÑ†Ğ¸Ğ·Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´Ğ°Ñ‚Ğ¾Ğº Ğ” 5%                   ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                        1,47",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                   28,10",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                   29,57",
      "",
      "         Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ñ– ĞºĞ¾ÑˆÑ‚Ğ¸ Ğ² ĞºĞ°ÑÑ–         ",
      "----------------------------------------",
      "ĞŸĞ¾Ñ‡Ğ°Ñ‚ĞºĞ¾Ğ²Ğ¸Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº                  0,00",
      "Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ¾Ğ²Ğµ Ğ²Ğ½ĞµÑĞµĞ½Ğ½Ñ                   0,00",
      "Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ¾Ğ²Ğµ Ğ²Ğ¸Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ                  0,00",
      "ĞšÑ–Ğ½Ñ†ĞµĞ²Ğ¸Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº                 1990,80",
      "",
      "----------------------------------------",
      "           27.05.2024 20:22:06          ",
      "                 ĞĞĞ›ĞĞ™Ğ                 ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "           Ğ¡Ğ›Ğ£Ğ–Ğ‘ĞĞ’Ğ˜Ğ™ Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢           ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      generateXZReport({
        ...xReportDataMock,
        receiptConfig: defaultReceiptConfig,
      }),
    ).toEqual(expectedReceipt);
  });

  it("generateZReport should have this structure", () => {
    const expectedReceipt = [
      "              Ğ¢ĞĞ’ Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ Ğ Ğ             ",
      '             "ĞšĞ°Ñ„Ğµ "ĞœÊ¼ÑÑ‚Ğ°""             ',
      "  Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ¿ĞµÑ‚Ñ€Ğ¾Ğ²ÑÑŒĞºĞ° Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ, Ğ¼. Ğ”Ğ½Ñ–Ğ¿Ñ€Ğ¾,  ",
      "   ĞĞ¼ÑƒÑ€-ĞĞ¸Ğ¶Ğ½ÑŒĞ¾Ğ´Ğ½Ñ–Ğ¿Ñ€Ğ¾Ğ²ÑÑŒĞºĞ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½, Ğ²ÑƒĞ».  ",
      "    Ğ¨Ğ¾Ğ»Ğ¾Ğ¼-ĞĞ»ĞµĞ¹Ñ…ĞµĞ¼Ğ°, 4, ĞºĞ². (ĞÑ„Ñ–Ñ) 31    ",
      "               Ğ†Ğ” 12345678              ",
      "           ĞšĞ°ÑĞ¸Ñ€ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾ Ğ¢.Ğ“.          ",
      "                Z-Ğ·Ğ²Ñ–Ñ‚ â„–1               ",
      "----------------------------------------",
      "Ğ—Ğ¼Ñ–Ğ½Ğ° Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ğ°       24.05.2024 16:20:05",
      "ĞÑÑ‚Ğ°Ğ½Ğ½Ñ–Ğ¹ Ñ„Ñ–ÑĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹  27.05.2024 20:22:06",
      "Ñ‡ĞµĞº                                     ",
      "Ğ¤Ñ–ÑĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€              2469255615",
      "Ğ¾ÑÑ‚Ğ°Ğ½ÑŒĞ¾Ğ³Ğ¾ Ñ‡ĞµĞºÑƒ                          ",
      "Ğ’Ğ°Ğ»ÑÑ‚Ğ° Ğ·Ğ²Ñ–Ñ‚Ñƒ                         Ğ³Ñ€Ğ½",
      "",
      "                 ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶                 ",
      "----------------------------------------",
      "Ğ—Ğ°Ğ³Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¾Ğ±Ñ–Ğ³                   2681,80",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                          2020,80",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                      661,00",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "                                        ",
      "ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ñ‡ĞµĞºÑ–Ğ²                       31",
      "",
      "ĞŸĞ”Ğ’ Ğ’ 7%                                ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                       24,60",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                  326,84",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                  351,44",
      "",
      "ĞŸĞ”Ğ’ Ğ“ 20%                               ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                      184,26",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                  737,04",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                  921,30",
      "",
      "ĞĞºÑ†Ğ¸Ğ·Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´Ğ°Ñ‚Ğ¾Ğº Ğ” 5%                   ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                      127,70",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                 2426,20",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                 2553,90",
      "",
      "               ĞŸĞ¾Ğ²ĞµÑ€Ğ½ĞµĞ½Ğ½Ñ               ",
      "----------------------------------------",
      "Ğ—Ğ°Ğ³Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¾Ğ±Ñ–Ğ³                     31,04",
      "Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ°                            30,00",
      "Ğ‘ĞµĞ·Ğ³Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ğ°                        1,04",
      "ĞšĞ°Ñ€Ñ‚ĞºĞ°                                  ",
      "ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ñ‡ĞµĞºÑ–Ğ²                        2",
      "",
      "ĞŸĞ”Ğ’ Ğ’ 7%                                ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                        2,03",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                   26,98",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                   29,01",
      "",
      "ĞĞºÑ†Ğ¸Ğ·Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´Ğ°Ñ‚Ğ¾Ğº Ğ” 5%                   ",
      "Ğ¡ÑƒĞ¼Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                        1,47",
      "ĞĞ±Ñ–Ğ³ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºÑƒ                   28,10",
      "ĞĞ±Ñ–Ğ³ Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ¼                   29,57",
      "",
      "         Ğ“Ğ¾Ñ‚Ñ–Ğ²ĞºĞ¾Ğ²Ñ– ĞºĞ¾ÑˆÑ‚Ğ¸ Ğ² ĞºĞ°ÑÑ–         ",
      "----------------------------------------",
      "ĞŸĞ¾Ñ‡Ğ°Ñ‚ĞºĞ¾Ğ²Ğ¸Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº                  0,00",
      "Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ¾Ğ²Ğµ Ğ²Ğ½ĞµÑĞµĞ½Ğ½Ñ                 100,00",
      "Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ¾Ğ²Ğµ Ğ²Ğ¸Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ                200,00",
      "ĞšÑ–Ğ½Ñ†ĞµĞ²Ğ¸Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº                 1890,80",
      "",
      "----------------------------------------",
      "           27.05.2024 20:22:06          ",
      "                 ĞĞĞ›ĞĞ™Ğ                 ",
      "           Ğ¤Ğ ĞŸĞ Ğ Ğ 4000244601           ",
      "           Ğ¤Ğ†Ğ¡ĞšĞĞ›Ğ¬ĞĞ˜Ğ™ Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢          ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      generateXZReport({
        ...zReportDataMock,
        receiptConfig: defaultReceiptConfig,
      }),
    ).toEqual(expectedReceipt);
  });
});

describe("cleanUpReceiptText", () => {
  it("should delete emoji on start", () => {
    const input = "â¤ï¸ Ğ¤Ñ–Ğ´Ğ¶Ğ¸ Ğ‘Ğ°Ñ‚ÑŒĞºÑ–Ğ²Ğ½Ğ°";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("Ğ¤Ñ–Ğ´Ğ¶Ğ¸ Ğ‘Ğ°Ñ‚ÑŒĞºÑ–Ğ²Ğ½Ğ°");
  });

  it("should delete inner emoji", () => {
    const input = "Ğ¤Ñ–Ğ´Ğ¶Ğ¸ â¤ï¸ Ğ‘Ğ°Ñ‚ÑŒĞºÑ–Ğ²Ğ½Ğ°";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("Ğ¤Ñ–Ğ´Ğ¶Ğ¸  Ğ‘Ğ°Ñ‚ÑŒĞºÑ–Ğ²Ğ½Ğ°");
  });

  it("should delete multi emoji", () => {
    const input = "ğŸ”¥âœ…Ğ Ğ¾Ğ´Ğ¸Ğ½Ğ° ğŸ‰";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("Ğ Ğ¾Ğ´Ğ¸Ğ½Ğ°");
  });

  it("should not change text without emoji", () => {
    const input = "ĞšĞ»Ñ–Ñ”Ğ½Ñ‚: Ğ‘Ğ°Ñ‚ÑŒĞºÑ–Ğ²Ğ½Ğ° Ğ¤Ñ–Ğ´Ğ¶Ğ¸";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("ĞšĞ»Ñ–Ñ”Ğ½Ñ‚: Ğ‘Ğ°Ñ‚ÑŒĞºÑ–Ğ²Ğ½Ğ° Ğ¤Ñ–Ğ´Ğ¶Ğ¸");
  });

  it("should delete ASCII control symbols", () => {
    const input = "Ğ¢ĞµÑÑ‚\u0002Ğ ÑĞ´Ğ¾Ğº\u0007";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("Ğ¢ĞµÑÑ‚ Ğ ÑĞ´Ğ¾Ğº");
  });

  it("should handle null and undefined", () => {
    expect(cleanUpReceiptText(null)).toBe("");
    expect(cleanUpReceiptText(undefined)).toBe("");
  });

  it("should not delete numbers", () => {
    const input = "Ğ¡ÑƒĞ¼Ğ°: 123,45 Ğ³Ñ€Ğ½";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("Ğ¡ÑƒĞ¼Ğ°: 123,45 Ğ³Ñ€Ğ½");
  });

  it("should trim empty space", () => {
    const input = "  ğŸ˜€ Hello ğŸ˜€ ";
    const output = cleanUpReceiptText(input);
    expect(output).toBe("Hello");
  });
});
